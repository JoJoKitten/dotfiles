#!/bin/bash

#  - autocd, no need to type 'cd' when changing directory
#  - cdspell, automatically fix directory typos when changing directory
#  - direxpand, automatically expand directory globs when completing
#  - dirspell, automatically fix directory typos when completing
#  - nocaseglob, case-insensitive globbing
shopt -s autocd cdspell direxpand dirspell nocaseglob

HISTSIZE= HISTFILESIZE= # Infinite history.
if [ ! -z $TERM ]; then
    export PS1="\[\033[1;31m\]\$(RET=\$?; [[ \$RET != 0 ]] && echo -n \$RET\ )\[\033[1;33m\]\W \[\033[1;32m\]> \[\033[0m\]"
fi

# vi-mode
set -o vi

# color
alias ls='ls -N --color=auto --group-directories-first'
alias grep="grep --color=auto"
alias diff="diff --color=auto"

# start ranger and change working directory on exit
rangercd() {
    tmp=$(mktemp)
    ranger "--cmd=set column_ratios 1,1" --choosedir="$tmp"
    cd $(cat $tmp)
    rm -f $tmp
}

# clear and ls
bind -x '"\C-l": clear'
bind -x '"\el": ls'

# fuzzy keybindings
source /usr/share/fzf/key-bindings.bash

# M-e find with fzf and open in editor
bind -x '"\ee": fzf --preview="head -$LINES {}" | xargs -r nvim'

# M-s to open ssh connection with fzf
bind -x '"\es": fzf_ssh'

# M-h to insert host with fzf
bind -x '"\eh": fzf_host'

# M-i to insert word from current tmux pane
bind -x '"\ei": tmux_copy'

# aliases
alias del=trash
alias fs=fzf_ssh
alias fsc=fzf_scp
alias fk=fzf_kill
alias ss='sudo systemctl'
alias e='emacsclient -t'
alias v='nvim'
alias vf='fzf | xargs -r nvim'
alias r='rangercd'
alias sr='sudo ranger'
alias ka='killall'

alias p='pacman'
alias pss='pacman -Ss'
alias sp='sudo pacman'
alias sps='sudo pacman -S'

alias g='git'
alias gs='git status'
alias ga='git add'
alias gc='git commit'
alias gd='git diff'
alias gl='git log'
alias gpl='git pull'
alias gps='git push'
